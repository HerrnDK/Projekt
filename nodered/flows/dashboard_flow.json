[
  {
    "id": "4985bdfbcf200fe6",
    "type": "tab",
    "label": "Projekt Automatisierung - FINAL (800x480 + QR offline)",
    "disabled": false,
    "info": ""
  },
  {
    "id": "0318f4604525f4f7",
    "type": "ui_tab",
    "name": "Welcome",
    "icon": "dashboard",
    "order": 1,
    "disabled": false,
    "hidden": false
  },
  {
    "id": "1a87758382986ddf",
    "type": "ui_tab",
    "name": "WiFi",
    "icon": "wifi",
    "order": 2,
    "disabled": false,
    "hidden": true
  },
  {
    "id": "b482803534c81cb7",
    "type": "ui_tab",
    "name": "Projekt-info",
    "icon": "info",
    "order": 3,
    "disabled": false,
    "hidden": false
  },
  {
    "id": "9db2c967c1a488ee",
    "type": "ui_tab",
    "name": "Projekt-Parametrierung",
    "icon": "tune",
    "order": 4,
    "disabled": false,
    "hidden": false
  },
  {
    "id": "3fe8602f3f429631",
    "type": "ui_tab",
    "name": "Projekt-Datenlog",
    "icon": "list",
    "order": 5,
    "disabled": false,
    "hidden": false
  },
  {
    "id": "1b4dd4e879ccb455",
    "type": "ui_group",
    "name": "Stop",
    "tab": "0318f4604525f4f7",
    "order": 1,
    "disp": true,
    "width": "14",
    "collapse": false,
    "className": ""
  },
  {
    "id": "6888e5abb8efb54d",
    "type": "ui_group",
    "name": "WLAN Anmeldung",
    "tab": "1a87758382986ddf",
    "order": 1,
    "disp": true,
    "width": 14,
    "collapse": false,
    "className": "desktop-only"
  },
  {
    "id": "18e42aa468913fd1",
    "type": "ui_group",
    "name": "WLAN Anmeldung",
    "tab": "1a87758382986ddf",
    "order": 2,
    "disp": true,
    "width": 10,
    "collapse": false,
    "className": "mobile-only"
  },
  {
    "id": "939aa8523e70cefb",
    "type": "ui_group",
    "name": "Status / Sensoren",
    "tab": "b482803534c81cb7",
    "order": 2,
    "disp": true,
    "width": 10,
    "collapse": false,
    "className": "mobile-only"
  },
  {
    "id": "3584a9c30b6db556",
    "type": "ui_group",
    "name": "Status / Sensoren",
    "tab": "b482803534c81cb7",
    "order": 1,
    "disp": true,
    "width": 14,
    "collapse": false,
    "className": "desktop-only"
  },
  {
    "id": "0ef8bd821a032b93",
    "type": "ui_group",
    "name": "Parametrierung",
    "tab": "9db2c967c1a488ee",
    "order": 1,
    "disp": true,
    "width": 14,
    "collapse": false,
    "className": "desktop-only"
  },
  {
    "id": "cd3e28787d1292e1",
    "type": "ui_group",
    "name": "Parametrierung",
    "tab": "9db2c967c1a488ee",
    "order": 2,
    "disp": true,
    "width": 10,
    "collapse": false,
    "className": "mobile-only"
  },
  {
    "id": "bdc119e647f71c57",
    "type": "ui_group",
    "name": "Datenlog",
    "tab": "3fe8602f3f429631",
    "order": 1,
    "disp": true,
    "width": 14,
    "collapse": false
  },
  {
    "id": "91a4f531eb00cb95",
    "type": "ui_group",
    "name": "",
    "tab": "0318f4604525f4f7",
    "order": 99,
    "disp": true,
    "width": "1",
    "collapse": false,
    "className": ""
  },
  {
    "id": "3430d891af8fa1f6",
    "type": "ui_base",
    "theme": {
      "name": "theme-light",
      "lightTheme": {
        "default": "#0094CE",
        "baseColor": "#0094CE",
        "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
        "edited": true,
        "reset": false
      },
      "darkTheme": {
        "default": "#097479",
        "baseColor": "#097479",
        "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
        "edited": false
      },
      "themeState": {
        "base-color": {
          "default": "#0094CE",
          "value": "#0094CE",
          "edited": false
        },
        "page-titlebar-backgroundColor": {
          "value": "#0094CE",
          "edited": false
        },
        "page-backgroundColor": {
          "value": "#fafafa",
          "edited": false
        },
        "page-sidebar-backgroundColor": {
          "value": "#ffffff",
          "edited": false
        },
        "group-textColor": {
          "value": "#1bbfff",
          "edited": false
        },
        "group-borderColor": {
          "value": "#ffffff",
          "edited": false
        },
        "group-backgroundColor": {
          "value": "#ffffff",
          "edited": false
        },
        "widget-textColor": {
          "value": "#111111",
          "edited": false
        },
        "widget-backgroundColor": {
          "value": "#0094ce",
          "edited": false
        },
        "widget-borderColor": {
          "value": "#ffffff",
          "edited": false
        }
      }
    },
    "site": {
      "name": "Node-RED Dashboard",
      "hideToolbar": "false",
      "allowSwipe": "false",
      "lockMenu": "false",
      "allowTempTheme": "true",
      "dateFormat": "DD.MM.YYYY",
      "sizes": {
        "sx": 48,
        "sy": 48,
        "gx": 6,
        "gy": 6,
        "cx": 6,
        "cy": 6,
        "px": 0,
        "py": 0
      }
    }
  },
  {
    "id": "4e62a4011a9a2d00",
    "type": "ui_template",
    "z": "4985bdfbcf200fe6",
    "group": "1b4dd4e879ccb455",
    "name": "Responsive CSS Global",
    "order": -1,
    "width": 0,
    "height": 0,
    "format": "<style>\n  * { box-sizing: border-box; }\n  html, body, md-content, .nr-dashboard-dashboard { overflow-x: hidden; }\n  .nr-dashboard-cardcontainer { padding: 4px; }\n  md-card { width: 100%; max-width: calc(100% - 8px); }\n\n  .mobile-only { display: none !important; }\n  .desktop-only { display: block !important; }\n\n  @media (max-width: 600px) {\n    .desktop-only { display: none !important; }\n    .mobile-only { display: block !important; }\n    md-card { margin: 2px !important; }\n    .nr-dashboard-cardcontainer { padding: 2px !important; }\n  }\n</style>",
    "storeOutMessages": false,
    "fwdInMessages": true,
    "resendOnRefresh": true,
    "templateScope": "global",
    "x": 140,
    "y": 50,
    "wires": [
      []
    ]
  },
  {
    "id": "080faa24e0dac224",
    "type": "ui_template",
    "z": "4985bdfbcf200fe6",
    "group": "91a4f531eb00cb95",
    "name": "QR Overlay - Welcome",
    "order": 1,
    "width": 1,
    "height": 1,
    "format": "<style>\n  .qr-overlay {\n    position: fixed;\n    inset: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    pointer-events: none;\n    z-index: 9999;\n  }\n  .qr-card {\n    background: #ffffff;\n    padding: 16px 18px;\n    border-radius: 12px;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);\n    text-align: center;\n  }\n  .qr-card img {\n    width: 220px;\n    height: 220px;\n    display: block;\n  }\n  .qr-hint {\n    margin-top: 8px;\n    font-size: 14px;\n    color: #333333;\n  }\n  @media (max-width: 600px) {\n    .qr-card {\n      padding: 12px 14px;\n    }\n    .qr-card img {\n      width: 180px;\n      height: 180px;\n    }\n    .qr-hint {\n      font-size: 13px;\n    }\n  }\n</style>\n<div class=\"qr-overlay\" ng-if=\"msg.payload && msg.payload.qrDataUrl\">\n  <div class=\"qr-card\">\n    <img ng-src=\"{{msg.payload.qrDataUrl}}\" alt=\"QR Code\" />\n    <div class=\"qr-hint\">{{msg.payload.qrHint}}</div>\n  </div>\n</div>",
    "storeOutMessages": false,
    "fwdInMessages": true,
    "resendOnRefresh": true,
    "templateScope": "local",
    "x": 1810,
    "y": 140,
    "wires": [
      []
    ]
  },
  {
    "id": "7e3a8a709a4fb946",
    "type": "ui_template",
    "z": "4985bdfbcf200fe6",
    "group": "1b4dd4e879ccb455",
    "name": "Welcome Anzeige (zentriert)",
    "order": 1,
    "width": 14,
    "height": 7,
    "format": "<div></div>",
    "storeOutMessages": false,
    "fwdInMessages": true,
    "resendOnRefresh": true,
    "templateScope": "local",
    "x": 1820,
    "y": 100,
    "wires": [
      []
    ]
  },
  {
    "id": "72b27a8d1b2172ad",
    "type": "ui_ui_control",
    "z": "4985bdfbcf200fe6",
    "name": "UI Navigation",
    "events": "none",
    "x": 1780,
    "y": 300,
    "wires": [
      []
    ]
  },
  {
    "id": "58697ef08e1da41e",
    "type": "ui_toast",
    "z": "4985bdfbcf200fe6",
    "position": "top right",
    "displayTime": "4",
    "topic": "Hinweis",
    "name": "Hinweis/Fehler",
    "x": 1780,
    "y": 220,
    "wires": []
  },
  {
    "id": "981f5b53b03dea16",
    "type": "inject",
    "z": "4985bdfbcf200fe6",
    "name": "Netzstatus Poll (1s)",
    "props": [],
    "repeat": "1",
    "once": true,
    "onceDelay": "0.5",
    "topic": "",
    "x": 140,
    "y": 100,
    "wires": [
      [
        "b52f203bb0efcdaf"
      ]
    ]
  },
  {
    "id": "b52f203bb0efcdaf",
    "type": "exec",
    "z": "4985bdfbcf200fe6",
    "command": "nmcli -t -f DEVICE,TYPE,STATE,CONNECTION device status",
    "name": "nmcli device status",
    "x": 350,
    "y": 100,
    "wires": [
      [
        "67b0ccf7efcdf30a"
      ],
      [],
      []
    ]
  },
  {
    "id": "67b0ccf7efcdf30a",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Netzstatus auswerten + QR Ziel bestimmen",
    "func": "const txt = (msg.payload || \"\").toString();\nconst lines = txt.split(/\r?\n/).filter(l => l.trim().length);\nlet wlanState = \"unknown\"; let wlanConn = \"\";\nfor (const l of lines) {\n  const parts = l.split(\":\");\n  const dev = parts[0];\n  const state = parts[2];\n  const con = parts.slice(3).join(\":\");\n  if (dev === \"wlan0\") { wlanState = state; wlanConn = con; }\n}\nconst apActive = (wlanState === \"connected\" && wlanConn === \"projekt-ap\");\nconst wifiConnected = (wlanState === \"connected\" && wlanConn && wlanConn !== \"projekt-ap\");\nflow.set(\"apActive\", apActive);\nflow.set(\"wifiConnected\", wifiConnected);\nflow.set(\"wlanConn\", wlanConn);\nlet statusText;\nif (wifiConnected) statusText = `WLAN verbunden (${wlanConn}). Projekt Dashboard aktiv.`;\nelse if (apActive) statusText = \"Access Point aktiv (Projekt-Setup). Bitte WLAN einrichten. Passwort: 1234568\";\nelse statusText = \"Kein WLAN verbunden.\";\nlet qrUrl; let qrHint;\nif (apActive) {\n  qrUrl = \"http://10.42.0.1:1880/ui/#!/1\";\n  qrHint = \"(Anmeldemaske)\";\n} else {\n  qrUrl = \"http://localhost:1880/ui/#!/1\";\n  qrHint = \"Projekt Dashboard öffnen\";\n}\nflow.set(\"qrHint\", qrHint);\nreturn [ { payload: statusText }, { payload: qrUrl } ];",
    "outputs": 2,
    "x": 650,
    "y": 100,
    "wires": [
      [
        "7e3a8a709a4fb946",
        "f3e0d2d5b9e3fe7e"
      ],
      [
        "8520ceb726888ed7"
      ]
    ]
  },
  {
    "id": "8520ceb726888ed7",
    "type": "exec",
    "z": "4985bdfbcf200fe6",
    "command": "/usr/bin/qrencode",
    "addpay": true,
    "append": "-t SVG -o -",
    "name": "QR erzeugen (qrencode SVG)",
    "x": 970,
    "y": 140,
    "wires": [
      [
        "8dab6698f54beec2"
      ],
      [
        "9e41764418b6e58a"
      ],
      []
    ]
  },
  {
    "id": "8dab6698f54beec2",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "SVG -> DataURL (msg.payload) + Broadcast",
    "func": "const hint = flow.get(\"qrHint\") || \"\"; const out = (msg.payload || \"\").toString(); const idx = out.indexOf(\"<svg\"); let dataUrl = \"\"; if (idx >= 0) { const svg = out.slice(idx).trim(); const enc = encodeURIComponent(svg).replace(/'/g, \"%27\").replace(/\"/g, \"%22\"); dataUrl = `data:image/svg+xml;charset=utf-8,${enc}`; } msg.payload = { qrDataUrl: dataUrl, qrHint: hint }; return msg;",
    "outputs": 1,
    "x": 1350,
    "y": 120,
    "wires": [
      [
        "080faa24e0dac224"
      ]
    ]
  },
  {
    "id": "9e41764418b6e58a",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "QR Fehler -> Toast",
    "func": "return { payload: `FEHLER QR-Erzeugung: ${(msg.payload||\"\").toString()}` };",
    "outputs": 1,
    "x": 1430,
    "y": 160,
    "wires": [
      [
        "58697ef08e1da41e"
      ]
    ]
  },
  {
    "id": "ecf0a293a33345bb",
    "type": "ui_dropdown",
    "z": "4985bdfbcf200fe6",
    "name": "SSID Auswahl",
    "label": "WLAN Netzwerk",
    "place": "WLAN auswählen",
    "group": "6888e5abb8efb54d",
    "order": 3,
    "width": 14,
    "height": 1,
    "passthru": true,
    "multiple": false,
    "options": [],
    "payload": "",
    "topic": "ssid",
    "topicType": "str",
    "x": 1260,
    "y": 200,
    "wires": [
      [
        "8cad023f93c60c7b"
      ]
    ]
  },
  {
    "id": "8cad023f93c60c7b",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "SSID merken",
    "func": "flow.set(\"selectedSsid\", msg.payload);\nreturn null;",
    "outputs": 0,
    "x": 1450,
    "y": 200,
    "wires": []
  },
  {
    "id": "3f09ba48c578bbfb",
    "type": "ui_text_input",
    "z": "4985bdfbcf200fe6",
    "name": "WLAN Passwort",
    "label": "Passwort",
    "group": "6888e5abb8efb54d",
    "order": 4,
    "width": 14,
    "height": 1,
    "passthru": true,
    "mode": "password",
    "delay": "0",
    "topic": "wifipw",
    "topicType": "str",
    "x": 120,
    "y": 360,
    "wires": [
      [
        "76d1a22c4e1fa5f9"
      ]
    ]
  },
  {
    "id": "76d1a22c4e1fa5f9",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Passwort merken",
    "func": "flow.set(\"wifiPassword\", msg.payload);\nreturn null;",
    "outputs": 0,
    "x": 1430,
    "y": 400,
    "wires": []
  },
  {
    "id": "8dd601ce12051b76",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Netzwerke neu laden",
    "group": "6888e5abb8efb54d",
    "order": 5,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Netzwerke neu laden",
    "icon": "refresh",
    "payload": "scan",
    "payloadType": "str",
    "topic": "cmd",
    "topicType": "str",
    "x": 140,
    "y": 220,
    "wires": [
      [
        "75dc3322e85fa3e0"
      ]
    ]
  },
  {
    "id": "75dc3322e85fa3e0",
    "type": "exec",
    "z": "4985bdfbcf200fe6",
    "command": "nmcli -t -f SSID device wifi list ifname wlan0 --rescan yes",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": true,
    "name": "WLAN Scan (SSID Liste)",
    "x": 590,
    "y": 220,
    "wires": [
      [
        "05522df437e8813a"
      ],
      [
        "5f5553a269048ff7"
      ],
      []
    ]
  },
  {
    "id": "05522df437e8813a",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "SSID Liste -> Dropdown (Strings)",
    "func": "const txt = (msg.payload || \"\").toString();\nconst lines = txt.split(/\\r?\\n/).map(l => l.trim()).filter(Boolean);\nlet ssids = [];\nlet seen = new Set();\nfor (const ssid of lines) { if (!ssid) continue; if (seen.has(ssid)) continue; seen.add(ssid); ssids.push(ssid); }\nssids.sort((a,b) => a.localeCompare(b, \"de\"));\nmsg.options = ssids; msg.payload = ssids.length ? ssids[0] : \"\"; if (msg.payload) flow.set(\"selectedSsid\", msg.payload); return msg;",
    "outputs": 1,
    "x": 980,
    "y": 200,
    "wires": [
      [
        "ecf0a293a33345bb"
      ]
    ]
  },
  {
    "id": "8bf2e73bf1f7f8ea",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Verbinden",
    "group": "6888e5abb8efb54d",
    "order": 6,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Verbinden",
    "icon": "check",
    "payload": "connect",
    "payloadType": "str",
    "topic": "cmd",
    "topicType": "str",
    "x": 100,
    "y": 280,
    "wires": [
      [
        "bfb23c18fc3e1340"
      ]
    ]
  },
  {
    "id": "ea0e7a991cc04ba3",
    "type": "ui_dropdown",
    "z": "4985bdfbcf200fe6",
    "name": "SSID Auswahl (Mobile)",
    "label": "WLAN Netzwerk",
    "place": "WLAN auswählen",
    "group": "18e42aa468913fd1",
    "order": 3,
    "width": 10,
    "height": 1,
    "passthru": true,
    "multiple": false,
    "options": [],
    "payload": "",
    "topic": "ssid",
    "topicType": "str",
    "x": 1260,
    "y": 240,
    "wires": [
      [
        "8cad023f93c60c7b"
      ]
    ]
  },
  {
    "id": "949192b053b434ab",
    "type": "ui_text_input",
    "z": "4985bdfbcf200fe6",
    "name": "WLAN Passwort (Mobile)",
    "label": "Passwort",
    "group": "18e42aa468913fd1",
    "order": 4,
    "width": 10,
    "height": 1,
    "passthru": true,
    "mode": "password",
    "delay": "0",
    "topic": "wifipw",
    "topicType": "str",
    "x": 120,
    "y": 400,
    "wires": [
      [
        "76d1a22c4e1fa5f9"
      ]
    ]
  },
  {
    "id": "19747b1e4d1db4db",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Netzwerke neu laden (Mobile)",
    "group": "18e42aa468913fd1",
    "order": 5,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Netzwerke neu laden",
    "icon": "refresh",
    "payload": "scan",
    "payloadType": "str",
    "topic": "cmd",
    "topicType": "str",
    "x": 140,
    "y": 260,
    "wires": [
      [
        "75dc3322e85fa3e0"
      ]
    ]
  },
  {
    "id": "6803eebdffe6afe1",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Verbinden (Mobile)",
    "group": "18e42aa468913fd1",
    "order": 6,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Verbinden",
    "icon": "check",
    "payload": "connect",
    "payloadType": "str",
    "topic": "cmd",
    "topicType": "str",
    "x": 100,
    "y": 320,
    "wires": [
      [
        "bfb23c18fc3e1340"
      ]
    ]
  },
  {
    "id": "5fedbca111dace7e",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Sensoren lesen (Mobile)",
    "group": "939aa8523e70cefb",
    "order": 1,
    "width": 10,
    "height": 1,
    "passthru": false,
    "label": "Sensoren aktualisieren",
    "tooltip": "READ Kommando senden",
    "icon": "refresh",
    "payload": "READ",
    "payloadType": "str",
    "topic": "",
    "x": 380,
    "y": 520,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "0d8e4bd65b6f369b",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "939aa8523e70cefb",
    "order": 2,
    "width": 10,
    "height": 1,
    "name": "A0 Display (Mobile)",
    "label": "Sensor A0",
    "format": "{{msg.payload.a0}}",
    "layout": "row-spread",
    "x": 600,
    "y": 560,
    "wires": []
  },
  {
    "id": "58c629f7381e64a0",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "939aa8523e70cefb",
    "order": 3,
    "width": 10,
    "height": 1,
    "name": "A1 Display (Mobile)",
    "label": "Sensor A1",
    "format": "{{msg.payload.a1}}",
    "layout": "row-spread",
    "x": 600,
    "y": 600,
    "wires": []
  },
  {
    "id": "9baf027087ee53a2",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "939aa8523e70cefb",
    "order": 4,
    "width": 10,
    "height": 1,
    "name": "Uptime Display (Mobile)",
    "label": "Uptime (ms)",
    "format": "{{msg.payload.uptime_ms}}",
    "layout": "row-spread",
    "x": 610,
    "y": 640,
    "wires": []
  },
  {
    "id": "bfb23c18fc3e1340",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Connect Kommando (nmcli)",
    "func": "const ssid = (flow.get(\"selectedSsid\") || \"\").toString();\nconst pw = (flow.get(\"wifiPassword\") || \"\").toString();\nif (!ssid) return [null, { payload: \"FEHLER: Bitte zuerst ein WLAN auswählen.\" }];\nif (!pw) return [null, { payload: \"FEHLER: Bitte ein WLAN Passwort eingeben.\" }];\nconst esc = (s) => s.replace(/[\"\\\\$`]/g, \"\\\\$&\");\nconst s = esc(ssid);\nconst p = esc(pw);\nmsg.payload = `connection delete \"${s}\"`;\nmsg.connectCmd = `dev wifi connect \"${s}\" password \"${p}\" ifname wlan0`;\nreturn [ msg, null ];",
    "outputs": 2,
    "x": 620,
    "y": 280,
    "wires": [
      [
        "dcc1a684b8ee9cfc"
      ],
      [
        "58697ef08e1da41e"
      ]
    ]
  },
  {
    "id": "982af834e8a01a70",
    "type": "exec",
    "z": "4985bdfbcf200fe6",
    "command": "nmcli",
    "addpay": true,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": true,
    "name": "WLAN Verbinden",
    "x": 930,
    "y": 280,
    "wires": [
      [
        "1e7ec73c81bb6611"
      ],
      [
        "6b2c54c623bc8715"
      ],
      []
    ]
  },
  {
    "id": "1e7ec73c81bb6611",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Connect OK -> Toast + Nav",
    "func": "return [ { payload: \"WLAN-Verbindung angestoßen.\" }, { payload: { tab: \"Projekt-info\" } } ];",
    "outputs": 2,
    "x": 1400,
    "y": 280,
    "wires": [
      [
        "58697ef08e1da41e"
      ],
      [
        "72b27a8d1b2172ad"
      ]
    ]
  },
  {
    "id": "6b2c54c623bc8715",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Connect ERR -> Toast",
    "func": "return { payload: `FEHLER bei WLAN-Verbindung: ${(msg.payload||\"\").toString()}` };",
    "outputs": 1,
    "x": 1420,
    "y": 320,
    "wires": [
      [
        "58697ef08e1da41e"
      ]
    ]
  },
  {
    "id": "5f5553a269048ff7",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Scan ERR -> Toast",
    "func": "return { payload: `FEHLER beim WLAN-Scan: ${(msg.payload||\"\").toString()}` };",
    "outputs": 1,
    "x": 1430,
    "y": 240,
    "wires": [
      [
        "58697ef08e1da41e"
      ]
    ]
  },
  {
    "id": "9176738c8c89f470",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "3584a9c30b6db556",
    "order": 2,
    "width": 7,
    "height": 1,
    "name": "A0 Display",
    "label": "Sensor A0",
    "format": "{{msg.payload.a0}}",
    "layout": "row-spread",
    "x": 600,
    "y": 560,
    "wires": []
  },
  {
    "id": "9c0ab803433d6479",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "3584a9c30b6db556",
    "order": 3,
    "width": 7,
    "height": 1,
    "name": "A1 Display",
    "label": "Sensor A1",
    "format": "{{msg.payload.a1}}",
    "layout": "row-spread",
    "x": 600,
    "y": 600,
    "wires": []
  },
  {
    "id": "92797bc31e9565c2",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "3584a9c30b6db556",
    "order": 4,
    "width": 7,
    "height": 1,
    "name": "Uptime Display",
    "label": "Uptime (ms)",
    "format": "{{msg.payload.uptime_ms}}",
    "layout": "row-spread",
    "x": 610,
    "y": 640,
    "wires": []
  },
  {
    "id": "f5c0bddf87cbb257",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Sensoren lesen",
    "group": "3584a9c30b6db556",
    "order": 1,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Sensoren aktualisieren",
    "tooltip": "READ Kommando senden",
    "icon": "refresh",
    "payload": "READ",
    "payloadType": "str",
    "topic": "",
    "x": 380,
    "y": 540,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "c0f8c18ec0927681",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 22 ON",
    "group": "0ef8bd821a032b93",
    "order": 2,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Pin 22 EIN",
    "tooltip": "Actuator Pin 22 einschalten",
    "bgcolor": "green",
    "icon": "arrow-circle-o-up",
    "payload": "ACT,22,1",
    "payloadType": "str",
    "topic": "",
    "x": 140,
    "y": 720,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "aa83e3ae7868acd9",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 22 OFF",
    "group": "0ef8bd821a032b93",
    "order": 3,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Pin 22 AUS",
    "tooltip": "Actuator Pin 22 ausschalten",
    "bgcolor": "red",
    "icon": "arrow-circle-o-down",
    "payload": "ACT,22,0",
    "payloadType": "str",
    "topic": "",
    "x": 140,
    "y": 760,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "86910374b7f6e4bf",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 23 ON",
    "group": "0ef8bd821a032b93",
    "order": 4,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Pin 23 EIN",
    "tooltip": "Actuator Pin 23 einschalten",
    "bgcolor": "green",
    "icon": "arrow-circle-o-up",
    "payload": "ACT,23,1",
    "payloadType": "str",
    "topic": "",
    "x": 140,
    "y": 800,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "ea97655e96f4df31",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 23 OFF",
    "group": "0ef8bd821a032b93",
    "order": 5,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Pin 23 AUS",
    "tooltip": "Actuator Pin 23 ausschalten",
    "bgcolor": "red",
    "icon": "arrow-circle-o-down",
    "payload": "ACT,23,0",
    "payloadType": "str",
    "topic": "",
    "x": 140,
    "y": 840,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "4ac1b66aca6f1626",
    "type": "link out",
    "z": "4985bdfbcf200fe6",
    "name": "to Arduino (from Dashboard)",
    "links": [
      "link_in_from_dashboard"
    ],
    "x": 720,
    "y": 560,
    "wires": []
  },
  {
    "id": "2a616d8b76b4fe2c",
    "type": "link in",
    "z": "4985bdfbcf200fe6",
    "name": "sensors from Arduino",
    "links": [
      "link_out_from_data"
    ],
    "x": 460,
    "y": 600,
    "wires": [
      [
        "9176738c8c89f470",
        "9c0ab803433d6479",
        "92797bc31e9565c2",
        "0d8e4bd65b6f369b",
        "58c629f7381e64a0",
        "9baf027087ee53a2"
      ]
    ]
  },
  {
    "id": "ac37d9126f690713",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "0ef8bd821a032b93",
    "order": 1,
    "width": 14,
    "height": 1,
    "name": "Arduino Steuerung Info",
    "label": "Arduino Steuerung",
    "format": "Digitale Ausgänge (Actuators) abfeuern →",
    "layout": "row-spread",
    "x": 1820,
    "y": 700,
    "wires": []
  },
  {
    "id": "a17a1a6c2b160f33",
    "type": "ui_text",
    "z": "4985bdfbcf200fe6",
    "group": "cd3e28787d1292e1",
    "order": 1,
    "width": 10,
    "height": 1,
    "name": "Arduino Steuerung Info (Mobile)",
    "label": "Arduino Steuerung",
    "format": "Digitale Ausgänge (Actuators) abfeuern →",
    "layout": "row-spread",
    "x": 1820,
    "y": 710,
    "wires": []
  },
  {
    "id": "c9b06de3c020cf3e",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 22 ON (Mobile)",
    "group": "cd3e28787d1292e1",
    "order": 2,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Pin 22 EIN",
    "tooltip": "Actuator Pin 22 einschalten",
    "bgcolor": "green",
    "icon": "arrow-circle-o-up",
    "payload": "ACT,22,1",
    "payloadType": "str",
    "topic": "",
    "x": 180,
    "y": 760,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "751fea17d2b1b531",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 22 OFF (Mobile)",
    "group": "cd3e28787d1292e1",
    "order": 3,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Pin 22 AUS",
    "tooltip": "Actuator Pin 22 ausschalten",
    "bgcolor": "red",
    "icon": "arrow-circle-o-down",
    "payload": "ACT,22,0",
    "payloadType": "str",
    "topic": "",
    "x": 180,
    "y": 800,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "8da6a75eaa79d3a4",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 23 ON (Mobile)",
    "group": "cd3e28787d1292e1",
    "order": 4,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Pin 23 EIN",
    "tooltip": "Actuator Pin 23 einschalten",
    "bgcolor": "green",
    "icon": "arrow-circle-o-up",
    "payload": "ACT,23,1",
    "payloadType": "str",
    "topic": "",
    "x": 180,
    "y": 840,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "9e5a1dc0c5928f70",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Actuator 23 OFF (Mobile)",
    "group": "cd3e28787d1292e1",
    "order": 5,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Pin 23 AUS",
    "tooltip": "Actuator Pin 23 ausschalten",
    "bgcolor": "red",
    "icon": "arrow-circle-o-down",
    "payload": "ACT,23,0",
    "payloadType": "str",
    "topic": "",
    "x": 180,
    "y": 880,
    "wires": [
      [
        "4ac1b66aca6f1626"
      ]
    ]
  },
  {
    "id": "152d67ddd441a63e",
    "type": "global-config",
    "env": [],
    "modules": {
      "node-red-dashboard": "3.6.6"
    }
  },
  {
    "id": "f3e0d2d5b9e3fe7e",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "WLAN Status -> UI",
    "func": "const connected = flow.get(\"wifiConnected\") === true;\nconst ssid = (flow.get(\"wlanConn\") || \"\").toString();\nmsg.payload = {\n  connected,\n  text: connected ? \"Verbunden\" : \"Verbindung getrennt\",\n  ssid: connected ? ssid : \"\"\n};\nreturn msg;",
    "outputs": 1,
    "x": 930,
    "y": 160,
    "wires": [
      [
        "1539acc33b962b98",
        "f43b9729d95dd412"
      ]
    ]
  },
  {
    "id": "1539acc33b962b98",
    "type": "ui_template",
    "z": "4985bdfbcf200fe6",
    "group": "6888e5abb8efb54d",
    "name": "WLAN Status Anzeige",
    "order": 1,
    "width": 7,
    "height": 1,
    "format": "<style>\n  .wifi-status { display: flex; align-items: center; gap: 8px; }\n  .wifi-dot { width: 12px; height: 12px; border-radius: 50%; background: #e74c3c; }\n  .wifi-dot.wifi-on { background: #2ecc71; }\n  .wifi-dot.wifi-off { background: #e74c3c; }\n  .wifi-text { font-weight: 600; }\n  .wifi-ssid { font-size: 12px; color: #666666; }\n</style>\n<div class=\"wifi-status\">\n  <span class=\"wifi-dot\" ng-class=\"(msg.payload && msg.payload.connected) ? 'wifi-on' : 'wifi-off'\"></span>\n  <span class=\"wifi-text\">{{msg.payload && msg.payload.text ? msg.payload.text : ''}}</span>\n  <span class=\"wifi-ssid\" ng-if=\"msg.payload && msg.payload.ssid\">({{msg.payload.ssid}})</span>\n</div>",
    "storeOutMessages": false,
    "fwdInMessages": true,
    "resendOnRefresh": true,
    "templateScope": "local",
    "x": 1230,
    "y": 120,
    "wires": [
      []
    ]
  },
  {
    "id": "f43b9729d95dd412",
    "type": "ui_template",
    "z": "4985bdfbcf200fe6",
    "group": "18e42aa468913fd1",
    "name": "WLAN Status Anzeige (Mobile)",
    "order": 1,
    "width": 5,
    "height": 1,
    "format": "<style>\n  .wifi-status { display: flex; align-items: center; gap: 8px; }\n  .wifi-dot { width: 12px; height: 12px; border-radius: 50%; background: #e74c3c; }\n  .wifi-dot.wifi-on { background: #2ecc71; }\n  .wifi-dot.wifi-off { background: #e74c3c; }\n  .wifi-text { font-weight: 600; }\n  .wifi-ssid { font-size: 12px; color: #666666; }\n</style>\n<div class=\"wifi-status\">\n  <span class=\"wifi-dot\" ng-class=\"(msg.payload && msg.payload.connected) ? 'wifi-on' : 'wifi-off'\"></span>\n  <span class=\"wifi-text\">{{msg.payload && msg.payload.text ? msg.payload.text : ''}}</span>\n  <span class=\"wifi-ssid\" ng-if=\"msg.payload && msg.payload.ssid\">({{msg.payload.ssid}})</span>\n</div>",
    "storeOutMessages": false,
    "fwdInMessages": true,
    "resendOnRefresh": true,
    "templateScope": "local",
    "x": 1230,
    "y": 160,
    "wires": [
      []
    ]
  },
  {
    "id": "25be634fd05b99f5",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Verbindung trennen",
    "group": "6888e5abb8efb54d",
    "order": 2,
    "width": 7,
    "height": 1,
    "passthru": false,
    "label": "Verbindung trennen",
    "icon": "close",
    "payload": "disconnect",
    "payloadType": "str",
    "topic": "cmd",
    "topicType": "str",
    "x": 480,
    "y": 360,
    "wires": [
      [
        "096abd417f75e29f"
      ]
    ]
  },
  {
    "id": "04814f9af8e7454b",
    "type": "ui_button",
    "z": "4985bdfbcf200fe6",
    "name": "Verbindung trennen (Mobile)",
    "group": "18e42aa468913fd1",
    "order": 2,
    "width": 5,
    "height": 1,
    "passthru": false,
    "label": "Verbindung trennen",
    "icon": "close",
    "payload": "disconnect",
    "payloadType": "str",
    "topic": "cmd",
    "topicType": "str",
    "x": 490,
    "y": 400,
    "wires": [
      [
        "096abd417f75e29f"
      ]
    ]
  },
  {
    "id": "096abd417f75e29f",
    "type": "exec",
    "z": "4985bdfbcf200fe6",
    "command": "nmcli device disconnect wlan0",
    "addpay": false,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": true,
    "name": "WLAN trennen",
    "x": 720,
    "y": 380,
    "wires": [
      [
        "9f39708044d8448c"
      ],
      [
        "347ff2895eeb5aa2"
      ],
      []
    ]
  },
  {
    "id": "9f39708044d8448c",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Trennen OK -> Toast",
    "func": "return { payload: \"WLAN-Verbindung getrennt.\" };",
    "outputs": 1,
    "x": 980,
    "y": 360,
    "wires": [
      [
        "58697ef08e1da41e"
      ]
    ]
  },
  {
    "id": "347ff2895eeb5aa2",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Trennen ERR -> Toast",
    "func": "return { payload: `FEHLER beim Trennen: ${(msg.payload||\"\").toString()}` };",
    "outputs": 1,
    "x": 990,
    "y": 400,
    "wires": [
      [
        "58697ef08e1da41e"
      ]
    ]
  },
  {
    "id": "dcc1a684b8ee9cfc",
    "type": "exec",
    "z": "4985bdfbcf200fe6",
    "command": "nmcli",
    "addpay": true,
    "append": "",
    "useSpawn": "false",
    "timer": "",
    "winHide": true,
    "name": "WLAN Profil löschen",
    "x": 770,
    "y": 320,
    "wires": [
      [
        "1314fa9599b0730c"
      ],
      [
        "1314fa9599b0730c"
      ],
      []
    ]
  },
  {
    "id": "1314fa9599b0730c",
    "type": "function",
    "z": "4985bdfbcf200fe6",
    "name": "Connect cmd -> nmcli",
    "func": "msg.payload = msg.connectCmd || \"\";\nreturn msg;",
    "outputs": 1,
    "x": 950,
    "y": 320,
    "wires": [
      [
        "982af834e8a01a70"
      ]
    ]
  }
]
